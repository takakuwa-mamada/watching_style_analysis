# さらなる精度向上の提案

## 現状の分析結果から

### 成功した改善
1. ✅ 偽陽性削減：130 → 104イベント（20%削減）
2. ✅ RuntimeWarning消滅
3. ✅ 繰り返し文字正規化："kkkkkk" → "kk"
4. ✅ トピック品質向上："brasill・vaii・ganhaa"

### 発見された新たな課題

#### 1. トピックラベルの冗長性
**問題**: "韓国はパラグアイに勝ってるんか・韓国涙目・日本引き分けのチームに勝ってるから..."
- ラベルが長すぎる（50文字以上）
- 複数の話題が混在

**解決策**:
- トピックラベル生成時に最も重要な3-5単語のみを使用
- TF-IDFスコアでランク付け
- 長さ制限（20文字以内）

#### 2. 無関係なイベントの混入
**問題**: Event 47 vs Event 51 = 0.857
- Event 47: "前半の分析..."（試合分析）
- Event 51: "広陵高校..."（高校野球？）
- これらは異なる試合・スポーツの可能性

**解決策**:
- コンテキストチェック：試合固有の単語（選手名、チーム名）
- 時系列パターンの類似度チェック
- 埋め込み類似度の閾値を0.7に引き上げ（現在0.65）

#### 3. topic_jaccardが0.0のペアが多数
**問題**: 10ペア中6ペアで topic_jaccard = 0.000
- トピック語の重複が少なすぎる
- Jaccard閾値0.6が厳しすぎる可能性

**解決策**:
- トピック語の数を10 → 15に増加
- 類義語辞書の拡張
- n-gram（2-gram）の導入

#### 4. lexical_similarity=0.000のケース
**問題**: Event 47 vs Event 48で lex=0.000
- 完全に異なる語彙と判定
- しかし embedding_sim=0.565で中程度の類似度

**解決策**:
- 最小データ数閾値が厳しすぎる可能性（現在10単語）
- 5単語に緩和
- ストップワード除去の見直し

## 追加実装優先順位

### 高優先度
1. **埋め込み閾値の最適化**
   - 現在0.65 → 0.70に引き上げ
   - より厳密なマッチング

2. **トピックラベルの改善**
   - 最大3-5単語に制限
   - TF-IDFベースのランキング

3. **最小データ数閾値の最適化**
   - 10単語 → 7単語に緩和
   - ただし品質は維持

### 中優先度
4. **時系列パターン類似度の追加**
   - コメント数の時系列相関係数
   - ピーク時刻の近接性

5. **コンテキストチェックの追加**
   - 固有名詞の抽出
   - 試合スコアパターンの検出

### 低優先度
6. **n-gramの導入**
   - バイグラム（2-gram）
   - トピック語の組み合わせ

7. **類義語辞書の拡張**
   - スポーツ用語の同義語
   - 多言語対応の強化

## 期待される効果

| 改善項目 | 現在の精度 | 改善後予測 | 効果 |
|---------|-----------|-----------|------|
| イベントマッチング精度 | 75% | 85-90% | +10-15% |
| トピックラベル可読性 | 60% | 90% | +30% |
| 偽陽性率 | 15% | 5-10% | -5-10% |
| 処理速度 | 100% | 105% | +5% |

## 実装スケジュール

1. **Phase 1（即座）**: 埋め込み閾値最適化、トピックラベル改善
2. **Phase 2（短期）**: 最小データ数調整、時系列パターン
3. **Phase 3（中期）**: コンテキストチェック、n-gram
