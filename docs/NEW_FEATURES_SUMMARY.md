# 新機能と精度向上の簡潔なまとめ

## 🎯 今回実装した3つの改善

### 1. **topic_jaccardの同義語正規化** ⭐ 精度向上
- **目的**: 多言語トピックの一致率を改善
- **変更点**: トピック比較前に同義語辞書で正規化
  - 例: "goal" = "ゴール" = "gol" → すべて"goal"として比較
- **効果**: topic_jaccard=0.0のペアが90%→50-60%に削減見込み

### 2. **時間的相関分析** ⭐ 新機能
- **目的**: コメント数の時系列パターンで検証
- **仕組み**: Pearson相関でイベント前後のコメント数変動を比較
  - 相関 > 0.3: 中程度の相関
  - 相関 > 0.5: combined_scoreに最大+10%ボーナス
- **効果**: 同じイベントの検出精度向上、誤検出削減

### 3. **信頼度スコア** ⭐ 新機能
- **目的**: イベントペアの信頼性を定量化
- **計算方法**: 4つのFactorの平均
  1. コメント数（多いほど高信頼）
  2. トピック数（適度にあるほど高信頼）
  3. 複数指標の一致度（embedding/topic/lexicalが揃うほど高信頼）
  4. 時間的相関（高いほど高信頼）
- **効果**: 結果の信頼性を0-1で評価可能

## 📊 CSV出力に追加された新カラム

1. `temporal_correlation`: 時間的相関係数 (0.0-1.0)
2. `confidence_score`: 信頼度スコア (0.0-1.0)
3. `topic_jaccard`: 改善版（同義語正規化適用済み）

## 🚀 使用例

```python
# 高信頼ペアの抽出
df = pd.read_csv('output/event_to_event_pairs.csv')
high_confidence = df[df['confidence_score'] > 0.7]

# 時間的相関の強いペア
strong_temporal = df[df['temporal_correlation'] > 0.5]

# 改善効果の確認
print(f"topic_jaccard > 0: {(df['topic_jaccard'] > 0).mean():.1%}")
```

## 📈 期待される改善

| 指標 | 改善前 | 改善後（目標） |
|------|--------|---------------|
| topic_jaccard=0のペア | 90% | 50-60% |
| 誤検出削減 | - | 20-30% |
| 高信頼ペア (>0.7) | - | 30%以上 |

## ⚙️ 技術的な特徴

- ✅ scipy不要（Pearson相関をnumpyで実装）
- ✅ 既存ライブラリのみ（numpy/pandas/matplotlib）
- ✅ 軽量で高速な実装
- ✅ 後方互換性あり（既存の出力も維持）
